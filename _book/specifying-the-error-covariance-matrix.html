<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Specifying the Error Covariance Matrix | MLM Study Guide for Caroline, by Caroline</title>
  <meta name="description" content="Chapter 6 Specifying the Error Covariance Matrix | MLM Study Guide for Caroline, by Caroline" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Specifying the Error Covariance Matrix | MLM Study Guide for Caroline, by Caroline" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Specifying the Error Covariance Matrix | MLM Study Guide for Caroline, by Caroline" />
  
  
  

<meta name="author" content="For doing better, for remediation. Integrating David’s class materials and Hoffman’s (2015) Longitudinal Analysis textbook to learn MLM with both R and SPSS." />


<meta name="date" content="2024-03-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="non-linear-time.html"/>
<link rel="next" href="anova-a-non-growth-curve-growth-curve-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MLM Study Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> First, why multilevel modeling?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#disadvantages-of-ranova"><i class="fa fa-check"></i><b>1.1</b> Disadvantages of RANOVA</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#disadvantages-of-locf"><i class="fa fa-check"></i><b>1.2</b> Disadvantages of LOCF</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#disadvantages-of-complex-imputation-e.g.-multiple-imputation"><i class="fa fa-check"></i><b>1.3</b> Disadvantages of complex imputation (e.g., multiple imputation)</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#advantages-of-mlm"><i class="fa fa-check"></i><b>1.4</b> Advantages of MLM</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="what-is-mlm-used-for.html"><a href="what-is-mlm-used-for.html"><i class="fa fa-check"></i><b>2</b> What is MLM used for?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="what-is-mlm-used-for.html"><a href="what-is-mlm-used-for.html#levels-of-analyses-in-mlm"><i class="fa fa-check"></i><b>2.1</b> Levels of analyses in MLM</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="what-is-mlm-used-for.html"><a href="what-is-mlm-used-for.html#level-1"><i class="fa fa-check"></i><b>2.1.1</b> Level 1</a></li>
<li class="chapter" data-level="2.1.2" data-path="what-is-mlm-used-for.html"><a href="what-is-mlm-used-for.html#level-2"><i class="fa fa-check"></i><b>2.1.2</b> Level 2</a></li>
<li class="chapter" data-level="2.1.3" data-path="what-is-mlm-used-for.html"><a href="what-is-mlm-used-for.html#summary"><i class="fa fa-check"></i><b>2.1.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="what-is-mlm-used-for.html"><a href="what-is-mlm-used-for.html#homework-1---0829"><i class="fa fa-check"></i><b>2.2</b> Homework 1 - 08/29</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html"><i class="fa fa-check"></i><b>3</b> Applying MLM to Longitudinal Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#overview"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#homework-2---0831"><i class="fa fa-check"></i><b>3.2</b> Homework 2 - 08/31</a></li>
<li class="chapter" data-level="3.3" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#quadratic-growth-curve-models"><i class="fa fa-check"></i><b>3.3</b> Quadratic Growth Curve Models</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#meaning-of-the-linear-vs.-quadratic-terms"><i class="fa fa-check"></i><b>3.3.1</b> Meaning of the Linear vs. Quadratic Terms</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#homework-3---0905"><i class="fa fa-check"></i><b>3.4</b> Homework 3 - 09/05</a></li>
<li class="chapter" data-level="3.5" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#homework-3.5---0215"><i class="fa fa-check"></i><b>3.5</b> Homework 3.5 - 02/15</a></li>
<li class="chapter" data-level="3.6" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#nested-models"><i class="fa fa-check"></i><b>3.6</b> Nested Models</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html"><i class="fa fa-check"></i><b>4</b> Treating Time More Flexibly</a>
<ul>
<li class="chapter" data-level="4.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#ml-vs.-reml"><i class="fa fa-check"></i><b>4.1</b> ML vs. REML</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#how-do-we-use-ml-methods-to-fit-a-multilevel-model-and-how-does-it-work"><i class="fa fa-check"></i><b>4.1.1</b> How do we use ML methods to fit a multilevel model, and how does it work?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#aic-vs.-bic"><i class="fa fa-check"></i><b>4.2</b> AIC vs. BIC</a></li>
<li class="chapter" data-level="4.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#degrees-of-freedom"><i class="fa fa-check"></i><b>4.3</b> Degrees of Freedom</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="non-linear-time.html"><a href="non-linear-time.html"><i class="fa fa-check"></i><b>5</b> Non-linear Time</a>
<ul>
<li class="chapter" data-level="5.1" data-path="non-linear-time.html"><a href="non-linear-time.html#when-quadratic-models-dont-fit-well"><i class="fa fa-check"></i><b>5.1</b> When Quadratic Models Don’t Fit Well</a></li>
<li class="chapter" data-level="5.2" data-path="non-linear-time.html"><a href="non-linear-time.html#logarithmic-growth-curve-models"><i class="fa fa-check"></i><b>5.2</b> Logarithmic Growth Curve Models</a></li>
<li class="chapter" data-level="5.3" data-path="non-linear-time.html"><a href="non-linear-time.html#hyperbolic-growth-curve-models"><i class="fa fa-check"></i><b>5.3</b> Hyperbolic Growth Curve Models</a></li>
<li class="chapter" data-level="5.4" data-path="non-linear-time.html"><a href="non-linear-time.html#piecewise-growth-curve-models"><i class="fa fa-check"></i><b>5.4</b> Piecewise Growth Curve Models</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="non-linear-time.html"><a href="non-linear-time.html#how-to-code-piecewise-models---jump-or-no-jump"><i class="fa fa-check"></i><b>5.4.1</b> How to Code Piecewise Models - Jump or No Jump?</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="non-linear-time.html"><a href="non-linear-time.html#further-notes-on-nonlinear-growth-curves"><i class="fa fa-check"></i><b>5.5</b> Further notes on nonlinear growth curves</a></li>
<li class="chapter" data-level="5.6" data-path="non-linear-time.html"><a href="non-linear-time.html#homework-4---0912"><i class="fa fa-check"></i><b>5.6</b> Homework 4 - 09/12</a></li>
<li class="chapter" data-level="5.7" data-path="non-linear-time.html"><a href="non-linear-time.html#homework-5---0914"><i class="fa fa-check"></i><b>5.7</b> Homework 5 - 09/14</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="specifying-the-error-covariance-matrix.html"><a href="specifying-the-error-covariance-matrix.html"><i class="fa fa-check"></i><b>6</b> Specifying the Error Covariance Matrix</a>
<ul>
<li class="chapter" data-level="6.1" data-path="specifying-the-error-covariance-matrix.html"><a href="specifying-the-error-covariance-matrix.html#why-care-about-error-covariance"><i class="fa fa-check"></i><b>6.1</b> Why care about error covariance?</a></li>
<li class="chapter" data-level="6.2" data-path="specifying-the-error-covariance-matrix.html"><a href="specifying-the-error-covariance-matrix.html#incorrect-assumptions-about-error-covariance"><i class="fa fa-check"></i><b>6.2</b> Incorrect Assumptions About Error Covariance</a></li>
<li class="chapter" data-level="6.3" data-path="specifying-the-error-covariance-matrix.html"><a href="specifying-the-error-covariance-matrix.html#random-effects-and-error-covariance"><i class="fa fa-check"></i><b>6.3</b> Random Effects and Error Covariance</a></li>
<li class="chapter" data-level="6.4" data-path="specifying-the-error-covariance-matrix.html"><a href="specifying-the-error-covariance-matrix.html#covariance-matrices"><i class="fa fa-check"></i><b>6.4</b> Covariance Matrices</a></li>
<li class="chapter" data-level="6.5" data-path="specifying-the-error-covariance-matrix.html"><a href="specifying-the-error-covariance-matrix.html#comparing-ecms-how-to-select-the-best-ecm"><i class="fa fa-check"></i><b>6.5</b> Comparing ECMs – How to select the best ECM</a></li>
<li class="chapter" data-level="6.6" data-path="specifying-the-error-covariance-matrix.html"><a href="specifying-the-error-covariance-matrix.html#ecms-and-growth-curve-models"><i class="fa fa-check"></i><b>6.6</b> ECMs and Growth Curve Models</a></li>
<li class="chapter" data-level="6.7" data-path="specifying-the-error-covariance-matrix.html"><a href="specifying-the-error-covariance-matrix.html#random-effects-and-ecms"><i class="fa fa-check"></i><b>6.7</b> Random Effects and ECMs</a></li>
<li class="chapter" data-level="6.8" data-path="specifying-the-error-covariance-matrix.html"><a href="specifying-the-error-covariance-matrix.html#homework-6---0919"><i class="fa fa-check"></i><b>6.8</b> Homework 6 - 09/19</a></li>
<li class="chapter" data-level="6.9" data-path="specifying-the-error-covariance-matrix.html"><a href="specifying-the-error-covariance-matrix.html#homework-7---0926"><i class="fa fa-check"></i><b>6.9</b> Homework 7 - 09/26</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="anova-a-non-growth-curve-growth-curve-model.html"><a href="anova-a-non-growth-curve-growth-curve-model.html"><i class="fa fa-check"></i><b>7</b> ANOVA: A non-growth curve growth curve model</a>
<ul>
<li class="chapter" data-level="7.1" data-path="anova-a-non-growth-curve-growth-curve-model.html"><a href="anova-a-non-growth-curve-growth-curve-model.html#anova-as-a-growth-curve-model"><i class="fa fa-check"></i><b>7.1</b> ANOVA as a Growth Curve Model</a></li>
<li class="chapter" data-level="7.2" data-path="anova-a-non-growth-curve-growth-curve-model.html"><a href="anova-a-non-growth-curve-growth-curve-model.html#section"><i class="fa fa-check"></i><b>7.2</b> </a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MLM Study Guide for Caroline, by Caroline</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="specifying-the-error-covariance-matrix" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Specifying the Error Covariance Matrix<a href="specifying-the-error-covariance-matrix.html#specifying-the-error-covariance-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="why-care-about-error-covariance" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Why care about error covariance?<a href="specifying-the-error-covariance-matrix.html#why-care-about-error-covariance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Research indicates that failure to properly specify the error covariance matrix (the matrix of variance and covariances of the errors in predicting outcome at each time point) of the repeated measures can lead to misleading and/or inaccurate results.</li>
<li>Typically, the regression coefficients are relatively accurately estimated, but the SD of the regression coefficients may not be correct, and the random effects may be wrong. Thus, we want to estimate it correctly.</li>
</ol>
</div>
<div id="incorrect-assumptions-about-error-covariance" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Incorrect Assumptions About Error Covariance<a href="specifying-the-error-covariance-matrix.html#incorrect-assumptions-about-error-covariance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Failing to specify a “repeated measures” variable in SPSS by default leads to SPSS assuming a Diagonal error covariance matrix (ECM), which assumes that the errors at the various assessments are unrelated. This is generally not true with repeated measures, unless the time between assessments is very long.</p>
<p>Scaled identity also assumes that the error variances at each time point are equal. Again, this too is often untrue. Thus, with repeated measures, we need to accurately specify the ECM. Despite this, most MLM programs default to Scaled Identity for the covariance of the errors of the repeated measures.</p>
</div>
<div id="random-effects-and-error-covariance" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Random Effects and Error Covariance<a href="specifying-the-error-covariance-matrix.html#random-effects-and-error-covariance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>When random effects are used, the errors in the error covariance matrix are AFTER accounting for the random effects.</li>
<li>However, Hoffman (2015) has shown that random effects themselves actually model correlations between errors, such that a random intercept actually models compound symmetry (homogeneous) of the errors.
<ul>
<li>Adding additional random effects create even more complex, but very specific, models of the error covariance matrix.</li>
<li>We will want to choose whether these random effects models are better than the other possible structures for the error covariance</li>
</ul></li>
</ul>
</div>
<div id="covariance-matrices" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Covariance Matrices<a href="specifying-the-error-covariance-matrix.html#covariance-matrices" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Unstructured Error Covariance Matrix (ECM)</strong></p>
<ul>
<li>The most general specification for the ECM is “unstructured”, which makes no assumptions about the ECM and just calculates each variance and covariance in the ECM from the data.</li>
</ul>
<p><strong>Other ECMs</strong></p>
<ul>
<li>Although one might assume that this is the most accurate (and indeed it is the most accurate, in that no other model will fit the data better), in some cases, another ECM specification may actually fit the data almost as well (i.e., not significantly worse).</li>
<li>Also, if you use unstructured, you will not have any dfs left over to calculate the random effects, so the regression coefficients are constrained to be equal for all subjects.</li>
<li>Overall, a better specification may, in some cases, be a simplified covariance matrix and a more complex model (including REs).</li>
<li>Hence we test different logical covariance structures and models to see if we can find a simpler model that still accurately fits the data.</li>
<li>The other models for the ECM that we typically examine are: Toeplitz, AR(1),Compound symmetry, and diagonal (see pp. 189-191 in HTT).</li>
<li>For each of these, we should examine both heterogeneous variances (allowing the variances at each assessment to differ) and homogeneous variances (constraining all the variances at the different assessments to be equal).</li>
</ul>
<p><strong>Toeplitz and Autoregressive ECMs</strong></p>
<ul>
<li>Toeplitz
<ul>
<li>This ECM assumes that the covariance between errors that are 1 assessment apart are the same, whether it is asmt 1 with asmt2, or asmt4 with asmt5, or any other asmts that are 1 asmt apart.</li>
<li>It also assumes that the covariances for the asmts that are 2 units apart are the same, etc.</li>
</ul></li>
<li>AR(1)
<ul>
<li>AR(1) assumes that the covariances between the errors decrease proportionately as the asmts get farther apart.</li>
<li>It calculates a rho (correlation) that represents the correlation between errors that are 1 asmt apart, and assumes that asmts that are more than 1 asmt apart have correlations that are proportionate to rho.</li>
</ul></li>
<li>So, asmts that are 2 units apart are correlated <span class="math inline">\(\rho*\rho\)</span>, and those 3 units apart are correlated <span class="math inline">\(\rho*\rho*\rho\)</span>, etc. In AR(1), asmts farther apart are necessarily less and less related. In Toeplitz, this is not assumed.</li>
</ul>
<p><strong>Compound Symmetry and Diagonal Covariance ECMs</strong></p>
<ul>
<li>Compound symmetry
<ul>
<li>CS assumes that ALL the off-diagonal covariances are equal. So, the covariance between asmt 1 and asmt 2 is the same as between asmt 2 and asmt 5, etc.</li>
<li>This is the assumption used in normal repeated measures ANOVA (referred to as sphericity). It is the same as having a random effect for the intercept.</li>
</ul></li>
<li>Diagonal
<ul>
<li>This is the heterogeneous variant of Scaled Identity. The covariances between asmts are assumed to be 0, but the variances of the errors at different asmts can differ.</li>
</ul></li>
</ul>
<p><strong>ECM Specifications</strong></p>
<p>Each of these ECMs can assume either heterogeneous variances at the different time points, or homogeneous variances at the different time points.</p>
<p>Below are how different covariance matrices would look for 3 timepoints:</p>
<p><em>Unstructured</em></p>
<p><span class="math display">\[
\begin{align*}
&amp; \; \; \; \; \; e_1 \; \; \; \; \; e_2 \; \; \; \; \; e_3 \\
&amp; e_1 \; \; \sigma_{11} \; \; \; \sigma_{12} \; \; \; \sigma_{13}\\
&amp; e_2 \; \; \sigma_{21} \; \; \; \sigma_{22} \; \; \; \sigma_{23}\\
&amp; e_3 \; \; \sigma_{31} \; \; \; \sigma_{32} \; \; \; \sigma_{33}
\end{align*}
\]</span></p>
<p><em>Scaled Identity</em></p>
<p><span class="math display">\[
\begin{align*}
&amp; \; \; \; \; \; e_1 \; \; \; \; \; e_2 \; \; \; \; \; e_3 \\
&amp; e_1 \; \; \sigma \; \; \; \, \; \; \,0 \; \; \;  \; \; \, \; 0\\
&amp; e_2 \; \;  0 \; \; \; \, \; \; \; \sigma \; \; \, \; \; \,\; 0\\
&amp; e_3 \; \;  0 \; \; \; \, \; \; \; 0 \; \; \; \, \; \; \; \sigma
\end{align*}
\]</span>
<em>Toeplitz Homogeneous</em></p>
<p><span class="math display">\[
\begin{align*}
&amp; \; \; \; \; \; e_1 \; \; \; \; \; e_2 \; \; \; \; \; e_3 \\
&amp; e_1 \; \; \sigma \; \; \;  \; \; \; \rho_1 \; \; \; \, \; \rho_2 \\
&amp; e_2 \; \;  0 \; \; \; \, \; \; \; \sigma \; \; \; \, \; \, \rho_1\\
&amp; e_3 \; \;  0 \; \; \; \, \; \; \; 0 \; \; \; \, \; \; \, \sigma
\end{align*}
\]</span>
<em>AR(1) Heterogeneous</em></p>
<p><span class="math display">\[
\begin{align*}
&amp; \; \; \; \; \; e_1 \; \; \; \; \; e_2 \; \; \; \; \; e_3 \\
&amp; e_1 \; \; \sigma_1 \; \; \;  \; \; \rho \; \; \; \, \; \rho*\rho\\
&amp; e_2 \; \;  0 \; \; \; \, \; \; \; \sigma_2 \; \; \; \, \; \, \rho\\
&amp; e_3 \; \;  0 \; \; \; \, \; \; \; 0 \; \; \; \, \; \; \, \sigma_3
\end{align*}
\]</span>
<em>Compound Symmetry Heterogeneous</em></p>
<p><span class="math display">\[
\begin{align*}
&amp; \; \; \; \; \; e_1 \; \; \; \; \; e_2 \; \; \; \; \; e_3 \\
&amp; e_1 \; \; \sigma_1 \; \; \; \; \; \rho \; \; \; \, \; \; \; \rho\\
&amp; e_2 \; \;  0 \; \; \; \, \; \; \; \sigma_2 \; \; \; \, \; \, \rho\\
&amp; e_3 \; \;  0 \; \; \; \, \; \; \; 0 \; \; \; \, \; \; \, \sigma_3
\end{align*}
\]</span></p>
</div>
<div id="comparing-ecms-how-to-select-the-best-ecm" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Comparing ECMs – How to select the best ECM<a href="specifying-the-error-covariance-matrix.html#comparing-ecms-how-to-select-the-best-ecm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Each of these ECM models are nested within the unstructured model (because they involve constraints to UN), so we can compare the -2LL of the models. But only if the more restrictive ECMs do not have random effects.</li>
<li>We select the model that is has the fewest parameters but whose -2LL is not different from the unstructured ECM.</li>
<li>We can use REML or ML since the models differ only on variance components. In this class, we will always use ML.</li>
</ul>
</div>
<div id="ecms-and-growth-curve-models" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> ECMs and Growth Curve Models<a href="specifying-the-error-covariance-matrix.html#ecms-and-growth-curve-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>It is important for both the ECM to be correct and for the model itself (growth curve formulation including both the correct fixed effects and random effects) to be correct for you to obtain the most accurate results.</li>
<li>Since the errors are going to be related to the growth curve model (GCM), one can’t really accurately select the ECM if the GCM is wrong.</li>
<li>Thus, for this class, we will start out with the unstructured ECM and decide on our GCM (linear, quadratic, log…) and then, when we have the model, we will select the ECM.</li>
<li>Remember, the regression coefficients in MLM are relatively robust to the specification of the ECM, but the variance components are not (and the SE’s of the regression coefficients are not robust to errors in the specification of the ECM).</li>
<li>Since the SE’s are not robust, the significance tests may be inaccurate if you use the wrong ECM.</li>
</ul>
</div>
<div id="random-effects-and-ecms" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Random Effects and ECMs<a href="specifying-the-error-covariance-matrix.html#random-effects-and-ecms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>What do we do with the REs? We cannot have REs in the unstructured ECM, but we can in the restricted models (although rarely can they be calculated in the Toeplitz heterogeneous model).</li>
<li>Thus, when selecting the ECM, you can add REs to the more restricted ECMs and compare these ECMs with REs to the unstructured model.</li>
<li>Since differences between models (which don’t have REs) involve only variance components, you can compare models using -2LL using REML. But for this class, we will always use ML.</li>
<li>Models with REs are not nested within the unstructured covariance matrix, so these models must be compared to the unstructured ECM model using AIC and BIC.</li>
</ul>
</div>
<div id="homework-6---0919" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Homework 6 - 09/19<a href="specifying-the-error-covariance-matrix.html#homework-6---0919" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this OCD treatment file that we have analyzed before, run linear, quadratic, LN, hyperbolic, and piecewise GCMs, using week as the time variable and centering at week 52. YBOCS is the DV. Fill in the model summary table. Use as many random effects as will converge. Which model fits the data best? Interpret the results from that model. Note that the discontinuity is week 16 (post treatment).</p>
<p><strong>Linear</strong></p>
<pre><code>MIXED YBOCS WITH condition weekc52
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=condition weekc52 condition*weekc52 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT weekc52 | SUBJECT(Subject#) COVTYPE(UN)
  /REPEATED=Index1 | SUBJECT(Subject#) COVTYPE(ID).</code></pre>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_22.png" /><!-- --></p>
<p><strong>Quadratic</strong></p>
<pre><code>MIXED YBOCS WITH condition weekc52 weekc52sq
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=condition weekc52 condition*weekc52 weekc52sq | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT weekc52 | SUBJECT(Subject#) COVTYPE(UN)
  /REPEATED=Index1 | SUBJECT(Subject#) COVTYPE(ID).</code></pre>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_23.png" /><!-- --></p>
<p><strong>LN</strong></p>
<pre><code>COMPUTE weekln=LN(week+1). *ln(week+1) since our coding starts at 0.
EXECUTE.

COMPUTE weeklnc3.97=weekln-3.97.
EXECUTE.

MIXED YBOCS WITH condition weeklnc3.97
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=condition weeklnc3.97 condition*weeklnc3.97 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT weeklnc3.97 | SUBJECT(Subject#) COVTYPE(UN)
  /REPEATED=Index1 | SUBJECT(Subject#) COVTYPE(ID).
  
*Dropped RE for weeklnc3.97 since final Hessian matrix was not positive definite. 

MIXED YBOCS WITH condition weeklnc3.97
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=condition weeklnc3.97 condition*weeklnc3.97 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(Subject#) COVTYPE(UN)
  /REPEATED=Index1 | SUBJECT(Subject#) COVTYPE(ID).</code></pre>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_24.png" /><!-- --></p>
<p><strong>Hyperbolic</strong></p>
<pre><code>COMPUTE weekhyper=1-(1/(week+1)).
EXECUTE.

COMPUTE weekhyperc.98=1-(1/(week+1))-.98.
EXECUTE.

MIXED YBOCS WITH condition weekhyperc.98
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=condition weekhyperc.98 condition*weekhyperc.98 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(Subject#) COVTYPE(UN)
  /REPEATED=Index1 | SUBJECT(Subject#) COVTYPE(ID).</code></pre>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_25.png" /><!-- --></p>
<p><strong>Piecewise</strong></p>
<pre><code>IF  (week &lt;= 16) wkd16c52p1=week-16.
EXECUTE.

IF  (week &gt; 16) wkd16c52p1=0.
EXECUTE.

IF  (week &gt;= 16) wkd16c52p2=weekc52.
EXECUTE.

RECODE wkd16c52p2 (MISSING=-36).
EXECUTE.

*Centering at week 52 and choosing discontinuity at week 16. 
MIXED YBOCS WITH condition wkd16c52p1 wkd16c52p2
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=condition wkd16c52p1 wkd16c52p2 condition*wkd16c52p1 condition*wkd16c52p2 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT wkd16c52p1 wkd16c52p2 | SUBJECT(Subject#) COVTYPE(UN)
  /REPEATED=Index1 | SUBJECT(Subject#) COVTYPE(ID).
  
  MIXED YBOCS WITH condition wkd16c52p1 wkd16c52p2
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=condition wkd16c52p1 wkd16c52p2 condition*wkd16c52p1 condition*wkd16c52p2 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT wkd16c52p1 | SUBJECT(Subject#) COVTYPE(UN)
  /REPEATED=Index1 | SUBJECT(Subject#) COVTYPE(ID).
  
  MIXED YBOCS WITH condition wkd16c52p1 wkd16c52p2
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=condition wkd16c52p2 condition*wkd16c52p1 condition*wkd16c52p2 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT wkd16c52p1 wkd16c52p2 | SUBJECT(Subject#) COVTYPE(UN)
  /REPEATED=Index1 | SUBJECT(Subject#) COVTYPE(ID).

*Got a positive definite error for both phases having REs, so had to only do random effects for the generic intercept.

MIXED YBOCS WITH condition wkd16c52p1 wkd16c52p2
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=condition wkd16c52p1 wkd16c52p2 condition*wkd16c52p1 condition*wkd16c52p2 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(Subject#) COVTYPE(UN)
  /REPEATED=Index1 | SUBJECT(Subject#) COVTYPE(ID).</code></pre>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_26.png" /><!-- --></p>
<p><strong>Model Summary Table</strong></p>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG27.png" /><!-- -->
Quadratic GCM had the lowest AIC, so was the best fitting model.</p>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG28.png" /><!-- --></p>
<ul>
<li><code>condition</code>: The difference between the two conditions (BT [0] and CT [1]) on YBOC at week 52 is not significant.</li>
<li><code>weekc52</code>: The effect of time on YBOC is not significant for participants in the BT condition (0) at week 52.</li>
<li><code>condition*weekc52</code>: The change in YBOC over time by different conditions is not significant.</li>
<li><code>weekc52sq</code>: The effect of time on YBOC is significant for participants in the BT condition (0) at week 52.</li>
</ul>
</div>
<div id="homework-7---0926" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Homework 7 - 09/26<a href="specifying-the-error-covariance-matrix.html#homework-7---0926" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Use hyperbolic weeks as the time variable (centered at the last assessment) and condition as the group variable. Include the time x condition interaction. The DV is CPSSIE. Run the model with an unstructured (UN) covariance matrix as your full model. Then, fill in the bottom of the table testing the various Covariance matrices and following the guidelines below the table. Which covariance model fits the data best (lowest AIC; or which has the fewest parameters but is not significantly worse than UN)? Use WEEKNEW as the WEEK variable.</p>
<pre><code>COMPUTE weeknewhyper=1-(1/(1+weeknew)).
EXECUTE.

COMPUTE weeknewhyperc.99=1-(1/(1+weeknew))-.99.
EXECUTE.</code></pre>
<pre><code>* Unstructured ECM. 

MIXED CPSSIE WITH weeknewhyperc.99 Condition
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=weeknewhyperc.99 Condition weeknewhyperc.99*Condition | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=weeknew | SUBJECT(SubjectID) COVTYPE(UN).</code></pre>
<pre><code>* Toeplitz (Heterogeneous) ECM. 

MIXED CPSSIE WITH weeknewhyperc.99 Condition
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=weeknewhyperc.99 Condition weeknewhyperc.99*Condition | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=weeknew | SUBJECT(SubjectID) COVTYPE(TPH).</code></pre>
<pre><code>* Toeplitz ECM. 

MIXED CPSSIE WITH weeknewhyperc.99 Condition
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=weeknewhyperc.99 Condition weeknewhyperc.99*Condition | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=weeknew | SUBJECT(SubjectID) COVTYPE(TP).</code></pre>
<pre><code>* AR(1):Heterogeneous ECM. 

MIXED CPSSIE WITH weeknewhyperc.99 Condition
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=weeknewhyperc.99 Condition weeknewhyperc.99*Condition | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT weeknewhyperc.99 | SUBJECT(SubjectID) COVTYPE(UN)
  /REPEATED=weeknew | SUBJECT(SubjectID) COVTYPE(ARH1).
  
MIXED CPSSIE WITH weeknewhyperc.99 Condition
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=weeknewhyperc.99 Condition weeknewhyperc.99*Condition | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(SubjectID) COVTYPE(UN)
  /REPEATED=weeknew | SUBJECT(SubjectID) COVTYPE(ARH1).</code></pre>
<pre><code>* AR(1) ECM. 

MIXED CPSSIE WITH weeknewhyperc.99 Condition
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=weeknewhyperc.99 Condition weeknewhyperc.99*Condition | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT weeknewhyperc.99 | SUBJECT(SubjectID) COVTYPE(UN)
  /REPEATED=weeknew | SUBJECT(SubjectID) COVTYPE(AR1).</code></pre>
<pre><code>* Compound Symmetry (Heterogeneous) ECM. 

MIXED CPSSIE WITH weeknewhyperc.99 Condition
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=weeknewhyperc.99 Condition weeknewhyperc.99*Condition | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT weeknewhyperc.99 | SUBJECT(SubjectID) COVTYPE(UN)
  /REPEATED=weeknew | SUBJECT(SubjectID) COVTYPE(CSH).</code></pre>
<pre><code>* Compound Symmetry ECM.

MIXED CPSSIE WITH weeknewhyperc.99 Condition
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=weeknewhyperc.99 Condition weeknewhyperc.99*Condition | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT weeknewhyperc.99 | SUBJECT(SubjectID) COVTYPE(UN)
  /REPEATED=weeknew | SUBJECT(SubjectID) COVTYPE(CS).

* RE removed. 

MIXED CPSSIE WITH weeknewhyperc.99 Condition
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=weeknewhyperc.99 Condition weeknewhyperc.99*Condition | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=weeknew | SUBJECT(SubjectID) COVTYPE(CS).</code></pre>
<pre><code>* Diagonal ECM. 

MIXED CPSSIE WITH weeknewhyperc.99 Condition
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=weeknewhyperc.99 Condition weeknewhyperc.99*Condition | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT weeknewhyperc.99 | SUBJECT(SubjectID) COVTYPE(UN)
  /REPEATED=weeknew | SUBJECT(SubjectID) COVTYPE(DIAG).
  
* RE removed. 

MIXED CPSSIE WITH Condition weeknewhyperc.99
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=Condition weeknewhyperc.99 Condition*weeknewhyperc.99 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(SubjectID) COVTYPE(UN)
  /REPEATED=weeknew | SUBJECT(SubjectID) COVTYPE(DIAG).</code></pre>
<pre><code>* Scaled Identity. 

MIXED CPSSIE WITH Condition weeknewhyperc.99
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=Condition weeknewhyperc.99 Condition*weeknewhyperc.99 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT weeknewhyperc.99 | SUBJECT(SubjectID) COVTYPE(UN)
  /REPEATED=weeknew | SUBJECT(SubjectID) COVTYPE(ID).</code></pre>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG29.png" /><!-- --></p>
<ul>
<li><code>condition</code>: The difference between the two conditions in terms of CPSSIE at week 66 is significant.</li>
<li><code>weekhyperc.99</code>: The effect of time on CPSSIE is significant for participants in condition 0 (PCT).<br />
</li>
<li><code>weekhyperc.99*condition</code>: The change in CPSSIE over time is different between the two conditions, since this term is significant. The rate of decrease in symptoms is more negative in condition 1 than in 0 over time.</li>
</ul>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG30.png" /><!-- --></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="non-linear-time.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="anova-a-non-growth-curve-growth-curve-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "sepia",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
