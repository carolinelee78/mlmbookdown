<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Applying MLM to Longitudinal Data | MLM Study Guide for Caroline, by Caroline</title>
  <meta name="description" content="Chapter 3 Applying MLM to Longitudinal Data | MLM Study Guide for Caroline, by Caroline" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Applying MLM to Longitudinal Data | MLM Study Guide for Caroline, by Caroline" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Applying MLM to Longitudinal Data | MLM Study Guide for Caroline, by Caroline" />
  
  
  

<meta name="author" content="For doing better, for remediation. Integrating David’s class materials and Hoffman’s (2015) Longitudinal Analysis textbook to learn MLM with both R and SPSS." />


<meta name="date" content="2024-02-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="what-is-mlm-used-for.html"/>
<link rel="next" href="treating-time-more-flexibly.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MLM Study Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> First, why multilevel modeling?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#disadvantages-of-ranova"><i class="fa fa-check"></i><b>1.1</b> Disadvantages of RANOVA</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#disadvantages-of-locf"><i class="fa fa-check"></i><b>1.2</b> Disadvantages of LOCF</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#disadvantages-of-complex-imputation-e.g.-multiple-imputation"><i class="fa fa-check"></i><b>1.3</b> Disadvantages of complex imputation (e.g., multiple imputation)</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#advantages-of-mlm"><i class="fa fa-check"></i><b>1.4</b> Advantages of MLM</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="what-is-mlm-used-for.html"><a href="what-is-mlm-used-for.html"><i class="fa fa-check"></i><b>2</b> What is MLM used for?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="what-is-mlm-used-for.html"><a href="what-is-mlm-used-for.html#levels-of-analyses-in-mlm"><i class="fa fa-check"></i><b>2.1</b> Levels of analyses in MLM</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="what-is-mlm-used-for.html"><a href="what-is-mlm-used-for.html#level-1"><i class="fa fa-check"></i><b>2.1.1</b> Level 1</a></li>
<li class="chapter" data-level="2.1.2" data-path="what-is-mlm-used-for.html"><a href="what-is-mlm-used-for.html#level-2"><i class="fa fa-check"></i><b>2.1.2</b> Level 2</a></li>
<li class="chapter" data-level="2.1.3" data-path="what-is-mlm-used-for.html"><a href="what-is-mlm-used-for.html#summary"><i class="fa fa-check"></i><b>2.1.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="what-is-mlm-used-for.html"><a href="what-is-mlm-used-for.html#homework-1---0829"><i class="fa fa-check"></i><b>2.2</b> Homework 1 - 08/29</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html"><i class="fa fa-check"></i><b>3</b> Applying MLM to Longitudinal Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#overview"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#homework-2---0831"><i class="fa fa-check"></i><b>3.2</b> Homework 2 - 08/31</a></li>
<li class="chapter" data-level="3.3" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#quadratic-growth-curve-models"><i class="fa fa-check"></i><b>3.3</b> Quadratic Growth Curve Models</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#meaning-of-the-linear-vs.-quadratic-terms"><i class="fa fa-check"></i><b>3.3.1</b> Meaning of the Linear vs. Quadratic Terms</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#homework-3---0905"><i class="fa fa-check"></i><b>3.4</b> Homework 3 - 09/05</a></li>
<li class="chapter" data-level="3.5" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#homework-3.5---0215"><i class="fa fa-check"></i><b>3.5</b> Homework 3.5 - 02/15</a></li>
<li class="chapter" data-level="3.6" data-path="applying-mlm-to-longitudinal-data.html"><a href="applying-mlm-to-longitudinal-data.html#nested-models"><i class="fa fa-check"></i><b>3.6</b> Nested Models</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html"><i class="fa fa-check"></i><b>4</b> Treating Time More Flexibly</a>
<ul>
<li class="chapter" data-level="4.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#ml-vs.-reml"><i class="fa fa-check"></i><b>4.1</b> ML vs. REML</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#how-do-we-use-ml-methods-to-fit-a-multilevel-model-and-how-does-it-work"><i class="fa fa-check"></i><b>4.1.1</b> How do we use ML methods to fit a multilevel model, and how does it work?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#aic-vs.-bic"><i class="fa fa-check"></i><b>4.2</b> AIC vs. BIC</a></li>
<li class="chapter" data-level="4.3" data-path="treating-time-more-flexibly.html"><a href="treating-time-more-flexibly.html#degrees-of-freedom"><i class="fa fa-check"></i><b>4.3</b> Degrees of Freedom</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="non-linear-time.html"><a href="non-linear-time.html"><i class="fa fa-check"></i><b>5</b> Non-linear Time</a>
<ul>
<li class="chapter" data-level="5.1" data-path="non-linear-time.html"><a href="non-linear-time.html#when-quadratic-models-dont-fit-well"><i class="fa fa-check"></i><b>5.1</b> When Quadratic Models Don’t Fit Well</a></li>
<li class="chapter" data-level="5.2" data-path="non-linear-time.html"><a href="non-linear-time.html#logarithmic-growth-curve-models"><i class="fa fa-check"></i><b>5.2</b> Logarithmic Growth Curve Models</a></li>
<li class="chapter" data-level="5.3" data-path="non-linear-time.html"><a href="non-linear-time.html#hyperbolic-growth-curve-models"><i class="fa fa-check"></i><b>5.3</b> Hyperbolic Growth Curve Models</a></li>
<li class="chapter" data-level="5.4" data-path="non-linear-time.html"><a href="non-linear-time.html#piecewise-growth-curve-models"><i class="fa fa-check"></i><b>5.4</b> Piecewise Growth Curve Models</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="non-linear-time.html"><a href="non-linear-time.html#how-to-code-piecewise-models---jump-or-no-jump"><i class="fa fa-check"></i><b>5.4.1</b> How to Code Piecewise Models - Jump or No Jump?</a></li>
<li class="chapter" data-level="5.4.2" data-path="non-linear-time.html"><a href="non-linear-time.html#graphing-piecewise-growth-curve-models"><i class="fa fa-check"></i><b>5.4.2</b> Graphing Piecewise Growth Curve Models</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="non-linear-time.html"><a href="non-linear-time.html#further-notes-on-nonlinear-growth-curves"><i class="fa fa-check"></i><b>5.5</b> Further notes on nonlinear growth curves</a></li>
<li class="chapter" data-level="5.6" data-path="non-linear-time.html"><a href="non-linear-time.html#homework-4---0912"><i class="fa fa-check"></i><b>5.6</b> Homework 4 - 09/12</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MLM Study Guide for Caroline, by Caroline</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="applying-mlm-to-longitudinal-data" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Applying MLM to Longitudinal Data<a href="applying-mlm-to-longitudinal-data.html#applying-mlm-to-longitudinal-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="overview" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Overview<a href="applying-mlm-to-longitudinal-data.html#overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Getting the “right” growth curve is critical since it can lead to misleading results if it is incorrect. So, graph the outcome data and make sure you understand the “growth curve” for individuals. Use “Plots” in “Univariate ANOVA” to look at what the growth curve looks like.</p>
<p>Also, MLM assumes multivariate normality, so we want to be sure that our data approaches normality (robust standard errors are available in Generalized Linear mixed models, which we will talk about later in the semester). They are robust to violations of multivariate normality. Also check for outliers. Use scatterplots and frequencies to look for outliers, skewness, normality.</p>
<p>Level-2 equations predict between person differences in the level-1 parameters (e.g., intercept and slope) in the level-1 growth curve model. Thus, the level-2 equations can be used to test if individual characteristics (e.g., treatment condition, demographic information, personality traits, etc.) predict these level-1 (within person) relations, answering questions like: is treatment condition significantly related to slope of change over time (b1).</p>
<ul>
<li>If you have a priori hypotheses (like a treatment condition effect that you want to test), you can go directly to testing that.</li>
<li>If you do not have a priori hypotheses, you usually look at the variance of the random effect for the slope, and if it is significant, then that means that there is significant variability in the slope between different people, so it is worthwhile to investigate predictors of that variability.</li>
<li>How do you test for variability in the slope? You can test the significance of <span class="math inline">\(\mu_{1i}\)</span>.</li>
</ul>
<p>When you substitute the level 2 equations into the level 1 model, you get the composite model that is estimated using maximum likelihood (ML) estimation.</p>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG5.jpg" /><!-- --></p>
<p>Note that since there is an interaction between Time and Condition, the main effects for Time and Condition do not reflect the “average” effect of Time or Condition, but rather the effect of one when the other is 0. Thus, if Time is “centered” at assessment 1 (baseline), then Timec1=0 is the baseline assessment and the effect of condition is thus the Condition effect at baseline, which you hope to be non-significant. The effect of Time in this model is the slope for those in Condition=0 (hopefully you do not code condition =1 or 2, since then the slope of Time (the main effect) is nonsensical).</p>
<p>One often runs the model twice, once for each treatment condition equaling 0, to get the slope (and significance) of Time for both treatment conditions. You can also run the model with treatment condition coded -.5, .5 to get the “average” effect of Time across both treatment conditions. This latter coding is not often done when treatment condition is the level 2 variable, since researchers rarely want to know about the average of placebo and treatment. It is more frequently done when the level 2 predictor of slope is a variable like gender, when you want to get the average slope across genders.</p>
<p>One also often runs the model with Time centered at various assessments to obtain the significance of treatment condition at the various assessments. Thus, if the variable Index1 codes the 4 assessments as 1,2,3,4, one might run the model alternately with Time centered at baseline (Timec1=Index1-1), at post-treatment (Timec3=Index1-3), and at FU (Timec4=Index1-4).</p>
<p>Proof that using Timec4 will give you condition differences at follow-up:</p>
<p><span class="math display">\[ Y = b_0 + b_1*Cond + b_2*Timec4 + b_3*Cond*Timec4 \]</span>
<span class="math display">\[ Y (Timec4 = 0) = b_0 + b_1*Cond + b_2*0 + b_3*Cond*0\]</span>
<span class="math display">\[= b_0 + b_1*Cond\]</span>
So the main effect for condition when time is centered at assessment 4 is the effect of condition at assessment 4 (FU; follow-up). Note the difference between that and the prediction of Y (using this same coding of time) at time 3:</p>
<p><span class="math display">\[ Y(Timec4 = 1) = b_0 + b_1*Cond + b_2*(-1) + b_3*(-1)*Cond \]</span>
<span class="math display">\[ = (b_0-b_2)+(b_1-b_3)*Cond \]</span></p>
</div>
<div id="homework-2---0831" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Homework 2 - 08/31<a href="applying-mlm-to-longitudinal-data.html#homework-2---0831" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Use the restructured OCD data file to rerun the analysis, using week (weeks from pre) as the time variable instead of index1. Use either a series of “computes” or use a “recode” to create the week variable. The “pre” assessment (index1=1) should be coded week=0. The week4 assessment (index1=2) should be coded week=4, etc. Then use condition, week, and condition x week as the fixed effects, and include a random effect for the intercept and for week (always use an unstructured covariance matrix for the random effects). Compare the results from this model to the results from the model we did in class.</p>
<p><strong>SPSS</strong></p>
<pre><code>*STEP 1. Recode index1 into week as the time variable. 

RECODE Index1 (1=0) (2=4) (3=16) (4=26) (5=52) (MISSING=SYSMIS) INTO week.
EXECUTE.</code></pre>
<pre><code>* STEP 2. Center week at week52.

COMPUTE week52=week-52.</code></pre>
<pre><code>* STEP 3. Run model. 

MIXED YBOC WITH condition week52
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=condition week52 condition*week52 | SSTYPE(3)
  /METHOD=REML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT week52 | SUBJECT(Subject#) COVTYPE(UN)
  /REPEATED=week | SUBJECT(Subject#) COVTYPE(ID).</code></pre>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG8.png" /><!-- --></p>
<p><strong>Interpretation of</strong> <em><strong>week52</strong></em> <strong>Main Effect</strong></p>
<p>There is a significant difference on the effect of time on YBOC (decline for when condition = 0).</p>
<p><strong>Interpretation of</strong> <em><strong>condition</strong></em> <strong>Main Effect</strong></p>
<p>Centering at assessment 52, there’s no significant effect of condition.</p>
<p><strong>Interpretation of the Interaction Effect</strong></p>
<p>The change in differences across conditions in terms of YBOCS over time is significant.</p>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG9.png" /><!-- --></p>
<p><strong>Interpretation of Covariance Parameters</strong></p>
<ul>
<li>.563 is the variability of the individual scores around the estimated average of their conditions at the last time point (UN1.1).</li>
<li>An individual’s average slope does vary around the average slope (UN2.2 – slope random effect – within each condition. Deviation for the average slope).</li>
<li>The higher the slope, the higher the intercept for each individual on average as this is a positive value for (UN2.1 - covariance).</li>
</ul>
<hr />
<p><strong>R</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="applying-mlm-to-longitudinal-data.html#cb4-1" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb4-2"><a href="applying-mlm-to-longitudinal-data.html#cb4-2" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code></pre></div>
<pre><code>## Loading required package: Matrix</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="applying-mlm-to-longitudinal-data.html#cb6-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="applying-mlm-to-longitudinal-data.html#cb10-1" tabindex="-1"></a>DF1 <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">&quot;Restructured_OCDMediationYBOCSBDI1inS.sav&quot;</span>)</span>
<span id="cb10-2"><a href="applying-mlm-to-longitudinal-data.html#cb10-2" tabindex="-1"></a>DF1<span class="sc">$</span>week <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(DF1<span class="sc">$</span>Index1, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb10-3"><a href="applying-mlm-to-longitudinal-data.html#cb10-3" tabindex="-1"></a>                                      <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">4</span>,</span>
<span id="cb10-4"><a href="applying-mlm-to-longitudinal-data.html#cb10-4" tabindex="-1"></a>                                      <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">16</span>,</span>
<span id="cb10-5"><a href="applying-mlm-to-longitudinal-data.html#cb10-5" tabindex="-1"></a>                                      <span class="st">`</span><span class="at">4</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">26</span>, </span>
<span id="cb10-6"><a href="applying-mlm-to-longitudinal-data.html#cb10-6" tabindex="-1"></a>                                      <span class="st">`</span><span class="at">5</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">52</span>)</span>
<span id="cb10-7"><a href="applying-mlm-to-longitudinal-data.html#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="applying-mlm-to-longitudinal-data.html#cb10-8" tabindex="-1"></a>DF1<span class="sc">$</span>Subject <span class="ot">&lt;-</span> DF1<span class="sc">$</span><span class="st">`</span><span class="at">Subject#</span><span class="st">`</span></span>
<span id="cb10-9"><a href="applying-mlm-to-longitudinal-data.html#cb10-9" tabindex="-1"></a></span>
<span id="cb10-10"><a href="applying-mlm-to-longitudinal-data.html#cb10-10" tabindex="-1"></a>DF1<span class="sc">$</span>week52 <span class="ot">&lt;-</span> DF1<span class="sc">$</span>week <span class="sc">-</span> <span class="dv">52</span> </span>
<span id="cb10-11"><a href="applying-mlm-to-longitudinal-data.html#cb10-11" tabindex="-1"></a></span>
<span id="cb10-12"><a href="applying-mlm-to-longitudinal-data.html#cb10-12" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(YBOC <span class="sc">~</span> week52 <span class="sc">+</span> condition <span class="sc">+</span> week52<span class="sc">*</span>condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> week52 <span class="sc">|</span> Subject), <span class="at">data =</span> DF1)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="applying-mlm-to-longitudinal-data.html#cb12-1" tabindex="-1"></a><span class="fu">summary</span>(model2, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: YBOC ~ week52 + condition + week52 * condition + (1 + week52 |  
##     Subject)
##    Data: DF1
## 
## REML criterion at convergence: 483.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.5887 -0.3930  0.1551  0.5829  2.4698 
## 
## Random effects:
##  Groups   Name        Variance  Std.Dev. Corr
##  Subject  (Intercept) 0.5907514 0.76860      
##           week52      0.0001433 0.01197  1.00
##  Residual             0.2134546 0.46201      
## Number of obs: 285, groups:  Subject, 62
## 
## Fixed effects:
##                   Estimate Std. Error t value
## (Intercept)       1.993824   0.171175  11.648
## week52           -0.021916   0.003283  -6.676
## condition         0.477315   0.238725   1.999
## week52:condition  0.009844   0.004559   2.159
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
</div>
<div id="quadratic-growth-curve-models" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Quadratic Growth Curve Models<a href="applying-mlm-to-longitudinal-data.html#quadratic-growth-curve-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A <strong>quadratic model of change</strong> includes a quadratic effect of time (i.e., as <span class="math inline">\(time^2\)</span>, otherwise known as the <em>quadratic rate of change</em>, or the <em>quadratic slope for time</em>) in addition to an intercept and a linear effect of time (i.e., as <span class="math inline">\(time^1\)</span>, otherwise known as the <em>linear rate of change</em>, or the <em>linear slope for time</em>). A quadratic effect of time implies a <em>change</em> in the linear rate of change over time, such that the linear time slope either <em>accelerates</em> (speeds up) or <em>decelerates</em> (slows down) over time.</p>
<p>The figure below illustrates how positive or negative linear or quadratic effects of time can work together to create many possible patterns of nonlinear change. First, the top left shows how a <em>positive</em> linear effect of time and a <em>positive</em> quadratic effect of time create an <strong>accelerating positive function</strong>, or a mean trajectory in which the rate of increase speeds up over time. Second, the top right shows how a <em>positive</em> linear effect of time and a <em>negative</em> quadratic effect of time create a <strong>decelerating positive function</strong>, or a mean trajectory in which the rate of increase slows down over time instead. Third, the bottom left shows how a <em>negative</em> linear effect of time and a <em>positive</em> quadratic effect of time create a <strong>decelerating negative function</strong>, or a mean trajectory in which the rate of decrease slows down over time. Finally, the bottom right shows how a <em>negative</em> linear effect of time and a <em>negative</em> quadratic effect of time create an <strong>accelerating negative function</strong>, or a mean trajectory in which the rate of decrease speeds over time. We cannot determine just from its sign if a quadratic effect creates acceleration or deceleration. A <em>positive</em> quadratic effect of time can make a positive linear effect of time <em>more positive</em> (acceleration), or it can make a negative linear effect of time <em>less negative</em> (deceleration). Similarly, a <em>negative</em> quadratic effect of time can make a negative linear effect of time <em>more negative</em> (acceleration).</p>
<p>Furthermore, just like any other predictor that varies over time, a quadratic effect of time can have both a fixed effect and a random effect. That is, a <strong>fixed quadratic effect of time</strong> in the model for the means implies a change in the linear rate of change <em>on average</em>. More specifically,
<img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG7.jpg" /><!-- --></p>
<p>Typically, in a treatment outcome study, the improvement in outcome over time levels off. Hence, we need to be able to model growth as curvilinear. We can do this by looking at the pattern of means across time, within condition, to get an idea of what the change in the means over time looks like.
- Remember that this is the pattern of means for the non-missing data, so it may not reflect MLM growth curves.</p>
<p>We can test for a quadratic curve by adding a “time squared” term to the level-1 MLM model. Note that we have a level-2 equation for every level 1 parameter, so with a quadratic growth curve, you will have 3 level-2 equations, adding the level-2 equation for the timesq term. The level 2 equation for the quadratic term does not <em>have</em> to have the same predictors that the linear time term has, but if it does have predictors, they must be included as predictors of linear time and the intercept. This is necessary to have all subcomponents of the interaction included in the model.</p>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG6.jpg" /><!-- -->
Be sure that the squared term uses the exact linear term, squared. Don’t use timec1 for the linear term and timec5-squared for the squared term. Otherwise, the meaning of the some of the coefficients (e.g., main effects) can become problematic. Even higher level terms (e.g., cubic, quartic, etc.) can also be added if needed.</p>
<div id="meaning-of-the-linear-vs.-quadratic-terms" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Meaning of the Linear vs. Quadratic Terms<a href="applying-mlm-to-longitudinal-data.html#meaning-of-the-linear-vs.-quadratic-terms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>When using a quadratic growth curve model, the regression coefficient for the linear term is the tangent to the curve at Time=0.</li>
<li>This makes sense when you think of the quadratic term as the interaction of time with time. Then, as in all interactions, the coefficient for the main effect for Time will be its relation with outcome when the other variable in the interaction (i.e., Time) is 0.</li>
<li>Thus, the regression coefficient for linear Time changes depending on where you center the time and timesq terms. Often, you will want to center these Time terms at the mean of Time. If you center Time at its average value, the regression coefficient for the linear time term will be the AVERAGE linear change over time.</li>
<li>You may also often want to center time at the last FU to compare groups at the last time point. In this case, the main effect for time will reflect the slope at that last time point.</li>
<li>Centering is just as important in quadratic models as in linear models. Be sure to use the same variable for the linear and quadratic terms (centered at the same time point). Then, the “condition” effect is the effect of treatment condition when Time equals 0.</li>
</ul>
</div>
</div>
<div id="homework-3---0905" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Homework 3 - 09/05<a href="applying-mlm-to-longitudinal-data.html#homework-3---0905" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Run the quadratic growth curve model using “weeks” as the time variable. Center at week 52. Include condition as a moderator of week and weeksq. Include a random effect (RE) for the intercept, week, and weeksq, but drop the RE for weeksq if the model won’t run. Drop the condition x weeksq interaction if it is not significant. Then compare the model fit (using AIC) to the model we ran in class using index1c5 as the time variable.</p>
<p><strong>SPSS</strong></p>
<pre><code>* STEP 1. Restructure dataset. 

VARSTOCASES
  /MAKE YBOCS FROM YBOCpre YBOC4 YBOC16 YBOC26 YBOC52
  /MAKE BDI FROM BDIpre BDI4 BDI16 BDI26 BDI52
  /INDEX=Index1(5)
  /KEEP=Subject# Age condition HAMTOT Male0
  /NULL=KEEP.</code></pre>
<pre><code>* STEP 2. Recode Index1 into Week. 

RECODE Index1 (MISSING=SYSMIS) (1=0) (2=4) (3=16) (4=26) (5=52) INTO week.
EXECUTE.</code></pre>
<pre><code>* STEP 3. Center week at last assessment and create quadratic term. 
COMPUTE weekc52=week-52.
EXECUTE.

COMPUTE weekc52sq=weekc52 ** 2.
EXECUTE.</code></pre>
<pre><code>* STEP 4. Run model... but final Hessian matrix is not positive definite! 

MIXED YBOCS WITH weekc52 weekc52sq condition
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=weekc52 weekc52sq condition weekc52*condition weekc52sq*condition | SSTYPE(3)
  /METHOD=REML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT weekc52 weekc52sq | SUBJECT(Subject#) COVTYPE(UN)
  /REPEATED=weekc52 | SUBJECT(Subject#) COVTYPE(ID).</code></pre>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG11.png" /><!-- --></p>
<pre><code>* STEP 5. Drop highest order random effect as final Hessian matrix was not positive definite. Remember that you can&#39;t drop lower order terms; if you&#39;re going to drop, you drop from the highest order down; also, don&#39;t drop terms that are part of your hypothsis. 

MIXED YBOCS WITH weekc52 weekc52sq condition
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=weekc52 weekc52sq condition weekc52*condition weekc52sq*condition | SSTYPE(3)
  /METHOD=REML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT weekc52 | SUBJECT(Subject#) COVTYPE(UN) * Note that we dropped random effect for weekc52sq
  /REPEATED=weekc52 | SUBJECT(Subject#) COVTYPE(ID).</code></pre>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG12.png" /><!-- --></p>
<pre><code>* STEP 6. Drop condition*weekssq as it is not significant. 

MIXED YBOCS WITH weekc52 weekc52sq condition
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0,
    ABSOLUTE)
  /FIXED=weekc52 weekc52sq condition weekc52*condition | SSTYPE(3) * Note that we dropped fixed effect for condition*weekssq interaction 
  /METHOD=REML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT weekc52 | SUBJECT(Subject#) COVTYPE(UN)
  /REPEATED=weekc52 | SUBJECT(Subject#) COVTYPE(ID).</code></pre>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG13.png" /><!-- --></p>
<p><strong>Interpretation of</strong> <em><strong>weekc52</strong></em> <strong>Main Effect</strong></p>
<p>The linear decrease in YBOCS in condition 0 at week 52 is not significant. Why would this be? Because the linear tangent to the quadratic change at week 52 would be a flat line, not a significant decrease.</p>
<p><strong>Interpretation of</strong> <em><strong>weekc52sq</strong></em> <strong>Main Effect</strong></p>
<p>There is a significant curvilinear change in YBOCS in condition 0 at week 52.</p>
<p><strong>Interpretation of</strong> <em><strong>condition</strong></em> <strong>Main Effect</strong></p>
<p>Difference in YBOCS across conditions at week 52 is not significant.</p>
<p><strong>Interpretation of</strong> <em><strong>week52</strong></em> <span class="math inline">\(\times\)</span> <em><strong>YBOCS</strong></em> <strong>Interaction Effect</strong></p>
<p>The change in differences across conditions in terms of YBOCS over time is significant.</p>
<p><strong>R</strong></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="applying-mlm-to-longitudinal-data.html#cb20-1" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb20-2"><a href="applying-mlm-to-longitudinal-data.html#cb20-2" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb20-3"><a href="applying-mlm-to-longitudinal-data.html#cb20-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="applying-mlm-to-longitudinal-data.html#cb21-1" tabindex="-1"></a>DF1 <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">&quot;Restructured_OCDMediationYBOCSBDI1inS.sav&quot;</span>)</span>
<span id="cb21-2"><a href="applying-mlm-to-longitudinal-data.html#cb21-2" tabindex="-1"></a>DF1<span class="sc">$</span>week <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(DF1<span class="sc">$</span>Index1, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb21-3"><a href="applying-mlm-to-longitudinal-data.html#cb21-3" tabindex="-1"></a>                                      <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">4</span>,</span>
<span id="cb21-4"><a href="applying-mlm-to-longitudinal-data.html#cb21-4" tabindex="-1"></a>                                      <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">16</span>,</span>
<span id="cb21-5"><a href="applying-mlm-to-longitudinal-data.html#cb21-5" tabindex="-1"></a>                                      <span class="st">`</span><span class="at">4</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">26</span>, </span>
<span id="cb21-6"><a href="applying-mlm-to-longitudinal-data.html#cb21-6" tabindex="-1"></a>                                      <span class="st">`</span><span class="at">5</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">52</span>)</span>
<span id="cb21-7"><a href="applying-mlm-to-longitudinal-data.html#cb21-7" tabindex="-1"></a></span>
<span id="cb21-8"><a href="applying-mlm-to-longitudinal-data.html#cb21-8" tabindex="-1"></a>DF1<span class="sc">$</span>Subject <span class="ot">&lt;-</span> DF1<span class="sc">$</span><span class="st">`</span><span class="at">Subject#</span><span class="st">`</span></span>
<span id="cb21-9"><a href="applying-mlm-to-longitudinal-data.html#cb21-9" tabindex="-1"></a></span>
<span id="cb21-10"><a href="applying-mlm-to-longitudinal-data.html#cb21-10" tabindex="-1"></a>DF1<span class="sc">$</span>week52 <span class="ot">&lt;-</span> DF1<span class="sc">$</span>week <span class="sc">-</span> <span class="dv">52</span> </span>
<span id="cb21-11"><a href="applying-mlm-to-longitudinal-data.html#cb21-11" tabindex="-1"></a></span>
<span id="cb21-12"><a href="applying-mlm-to-longitudinal-data.html#cb21-12" tabindex="-1"></a>DF1<span class="sc">$</span>week52sq <span class="ot">&lt;-</span> DF1<span class="sc">$</span>week52<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb21-13"><a href="applying-mlm-to-longitudinal-data.html#cb21-13" tabindex="-1"></a></span>
<span id="cb21-14"><a href="applying-mlm-to-longitudinal-data.html#cb21-14" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(YBOC <span class="sc">~</span> week52 <span class="sc">+</span> (week52<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> condition <span class="sc">+</span> week52<span class="sc">*</span>condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> week52 <span class="sc">|</span> Subject), <span class="at">data =</span> DF1)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="applying-mlm-to-longitudinal-data.html#cb23-1" tabindex="-1"></a><span class="fu">summary</span>(model3, <span class="at">corr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: YBOC ~ week52 + (week52^2) + condition + week52 * condition +  
##     (1 + week52 | Subject)
##    Data: DF1
## 
## REML criterion at convergence: 483.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.5887 -0.3930  0.1551  0.5829  2.4698 
## 
## Random effects:
##  Groups   Name        Variance  Std.Dev. Corr
##  Subject  (Intercept) 0.5907514 0.76860      
##           week52      0.0001433 0.01197  1.00
##  Residual             0.2134546 0.46201      
## Number of obs: 285, groups:  Subject, 62
## 
## Fixed effects:
##                   Estimate Std. Error t value
## (Intercept)       1.993824   0.171175  11.648
## week52           -0.021916   0.003283  -6.676
## condition         0.477315   0.238725   1.999
## week52:condition  0.009844   0.004559   2.159
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<p>Now try to graph the model using index1c5. Graph 2 models: the one WITH the condition x index1c5sq included, and the one WITHOUT condition x index1c5sq. Remember the trick you have to use to graph when the time variable is a transformed variable (you have to use the TRANSFORMED variable in the excel spreadsheet, not the raw 1,2,3,4,5 variable).</p>
<p><strong>Excel</strong></p>
<p>Model 1 (with condition*index1c5sq)</p>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG14.png" /><!-- --></p>
<p>Model 2 (without condition*index1c5sq)</p>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG15.png" /><!-- --></p>
</div>
<div id="homework-3.5---0215" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Homework 3.5 - 02/15<a href="applying-mlm-to-longitudinal-data.html#homework-3.5---0215" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here is the description of the attached file: This is data from a 2 group study (Prolonged exposure (PE, coded PE0=0)) vs. control (coded PE0=1)) on PTSD symptoms (CPSSIE, which is the DV). Use Index1 as your time variable. Model a quadratic growth curve. Are there treatment condition differences in CPSSIE at the last assessment? Graph the model. What is the average linear decrease (slope) in symptoms per Unit of index1 for those in the PE condition?</p>
<p><strong>SPSS</strong></p>
<pre><code>* STEP 1. Create centered variable and quadratic term.

COMPUTE Index1c23=Index1 - 23.
EXECUTE.

COMPUTE Index1c23sq=Index1c23 ** 2.
EXECUTE.</code></pre>
<pre><code>* STEP 2. Run model with unstructured.

MIXED CPSSIE WITH Index1c23 Index1c23sq pe0
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)    
  /FIXED=Index1c23 Index1c23sq pe0 Index1c23*pe0 Index1c23sq*pe0 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT Index1c23 Index1c23sq | SUBJECT(SubjectID) COVTYPE(UN)
  /REPEATED=Index1c23 | SUBJECT(SubjectID) COVTYPE(UN).</code></pre>
<pre><code>* STEP 3. Did not converge, so going down the list of Model Selection Table. 

* Toeplitz - Heterogeneous - did not converge. 
 
* Toeplitz - did not converge. 

* AR1 Heterogeneous - did not converge. 

* AR1 - converged! 
  
 MIXED CPSSIE WITH Index1c23 Index1c23sq pe0
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)    
  /FIXED=Index1c23 Index1c23sq pe0 Index1c23*pe0 Index1c23sq*pe0 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT Index1c23 Index1c23sq | SUBJECT(SubjectID) COVTYPE(UN)
  /REPEATED=Index1c23 | SUBJECT(SubjectID) COVTYPE(AR1).</code></pre>
<p><strong>Are there treatment condition differences in CPSSIE at the last assessment? Graph the model. </strong></p>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG16.png" /><!-- --></p>
<p>The main effect for pe0 indicates that the difference in CPSSIE across conditions at the last assessment is significant.</p>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG18.png" /><!-- --></p>
<p><strong>What is the average linear decrease (slope) in symptoms per Unit of index1 for those in the PE condition?</strong></p>
<pre><code>* STEP 1. Centering time (index1) at its average value, the regression coefficient for the linear time term will be the AVERAGE linear change over time. 

DESCRIPTIVES VARIABLES=Index1
  /STATISTICS=MEAN.

* Average is 13.35, so centering linear and quadratic terms at 13.35. 

COMPUTE Index1c13.35=Index1 - 13.35.
EXECUTE.

COMPUTE Index1c13.35sq= Index1c13.35 ** 2.
EXECUTE.</code></pre>
<pre><code>* STEP 2. Run model. 

* Did not converge with unstructured, going down the list. 

* Converged with AR1. 

MIXED CPSSIE WITH Index1c13.35 Index1c13.35sq pe0
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(100) MXSTEP(10) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)    
  /FIXED=Index1c13.35 Index1c13.35sq pe0 Index1c13.35*pe0 Index1c13.35sq*pe0 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT Index1c13.35 Index1c13.35sq | SUBJECT(SubjectID) COVTYPE(UN)
  /REPEATED=Index1c13.35 | SUBJECT(SubjectID) COVTYPE(AR1).
</code></pre>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG17.png" /><!-- --></p>
<p>The average linear decrease in CPSSIE for those in the PE condition (pe0 = 0) is significant. This is because the linear tangent to the quadratic change on average shows a significant negative linear trend.</p>
<p><img src="https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/quadratic.gif" /><!-- --></p>
</div>
<div id="nested-models" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Nested Models<a href="applying-mlm-to-longitudinal-data.html#nested-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A smaller model (one with fewer parameters) is nested within a larger model if the larger model has ALL the parameters included in the smaller model, plus at least 1 additional parameter. Or, a smaller model is nested within a larger model if you can derive the smaller model by putting 1 or more restrictions on the larger model.</p>
<ul>
<li>“Parameters” includes both fixed effects and random effects (variance components).</li>
<li>You can <strong>statistically</strong> compare <strong>nested</strong> models for relative “goodness of fit” using the difference in the -2LL.</li>
<li>The difference in the -2LL of the 2 models is a chi-square whose degrees of freedom is the difference in the number of parameters estimated by the 2 models.</li>
<li>Note that ML estimation must be used if your comparisons between models involve ANY differences in fixed effects (in your predictors/covariates) including differences in fixed effects and variance components</li>
<li>However, if your models involve different fixed effects (except additional effects in the full model, since the full model by definition has fixed effects that are not in the nested model), you cannot compare them with -2LL. You must use AIC/BIC.</li>
</ul>
<p>REML can be used to compare models that differ <em>only</em> on variance components (e.g., random effects and covariances). However, these models can also be tested using ML, so you can just default to using ML for all comparisons.</p>
<ul>
<li>For all likelihood ratio tests (i.e., tests using the difference in the -2LL), regardless of using ML or REML, the 2-tailed p-value should be divided by 2 (i.e., use a 1 tailed test) to obtain the correct p-value (Berkhof &amp; Snijders, 2001), basically because the -2LL of the restricted model is always larger than the -2LL of the fuller model (i.e., it is a unidirectional test).</li>
<li>This website can perform one tailed <span class="math inline">\(\chi^2\)</span> tests so that we don’t need to divide by 2: <a href="https://www.danielsoper.com/statcalc/calculator.aspx?id=11">Daniel Soper One-Tailed <span class="math inline">\(\chi^2\)</span> Test Calculator</a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="what-is-mlm-used-for.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="treating-time-more-flexibly.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "sepia",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
