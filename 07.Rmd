# Exam 1 

## Question 1
- Use NIMH.sav. The outcome variable is child externalizing problems (TCBCEXTT). There are 6 assessments (asmts), each 4 months apart. The study is a randomized controlled trial with a treatment group (PS, for project support) and a control group (TAU, treatment as usual). 
- Treatment condition is coded in variable COND10, such that PS=0 and TAU=1. Asmt=1 is baseline, asmt=2 is during the intervention, and asmt 3 is the posttreatment score (at end of treatment). The follow-up (FU) period begins immediately after asmt 3 (i.e., don’t use a jump or “phase” code, just use 2 slopes in a piecewise analysis). ASMTS 4-6 are follow up asmts. Use asmt number as your Time variable in all analyses. 
- Our goal is to select the best growth curve model for TCBCEXTT over time and between groups (use the full model selection table (except discontinuous with jump) with ECMs), and to answer the following questions FOR THE FINAL (best-fitting) MODEL ONLY (the final growth model with the final ECM): 
  * 1) Are there differences in the slopes between the groups?
  * 2) Are the slopes significant in each group?
  * 3) Are there differences between groups at post (asmt 3) and at the final FU? (If the best model is piecewise, answer questions 1 and 2 for both phases of the study. If the best model is quadratic, answer questions 1 and 2 for the average linear slope). 
- Graph the final (best fitting) model. Then, in addition, describe/summarize, in real, understandable language, all the results in a, b, and c that are significant. In the file that includes your final model selection table, add a section AFTER the model selection table, that lists any steps taken to exclude random effects and/or to drop interactions (if you do so), both to simplify the model and/or because the model would not converge. 
- Use my Model Selection Table that I have provided with the exam to list the details for each final model for each type of growth curve and each covariance matrix of the repeated measures. Highlight the best fitting growth curve model and the best fitting covariance structure in the Model Selection Table. 
  * If, when using AIC and BIC to decide between models, the AIC and BIC give different recommendations, use the AIC. For piecewise models, we predict treatment condition differences during both the treatment and follow-up phases so do not drop treatment x time interactions for either phase. 
  * For purposes of this exam, do not use random effects for any unstructured or Toeplitz error covariance matrices. Do use random effects for AR(1), compound symmetry (heterogeneous), diagonal, and scaled identity models. See further instructions in the notes of the Model Selection Table.

**Model Selection Table** 

Assessing fit of growth curve models: 

```
*LINEAR. 

MIXED TCBCEXTT WITH cond10 ASMT 
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)  
    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)     
  /FIXED=cond10 ASMT cond10*ASMT | SSTYPE(3) 
  /METHOD=ML 
  /PRINT=SOLUTION TESTCOV 
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(UN). 
```

```
*QUADRATIC. 

COMPUTE ASMTSQ=ASMT ** 2. 
EXECUTE. 

MIXED TCBCEXTT WITH cond10 ASMT ASMTSQ 
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)  
    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)     
  /FIXED=cond10 ASMT cond10*ASMT ASMTSQ cond10*ASMTSQ | SSTYPE(3) 
  /METHOD=ML 
  /PRINT=SOLUTION TESTCOV 
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(UN). 

* Dropping cond10*ASMTSQ fixed effect since it is not significant per exam instructions.
MIXED TCBCEXTT WITH cond10 ASMT ASMTSQ 
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)  
    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)     
  /FIXED=cond10 ASMT cond10*ASMT ASMTSQ | SSTYPE(3) 
  /METHOD=ML 
  /PRINT=SOLUTION TESTCOV 
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(UN). 
```

```
*LOG.
COMPUTE ASMTLN=LN(ASMT). 
EXECUTE. 

MIXED TCBCEXTT WITH cond10 ASMTLN 
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)  
    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)     
  /FIXED=cond10 ASMTLN cond10*ASMTLN | SSTYPE(3) 
  /METHOD=ML 
  /PRINT=SOLUTION TESTCOV 
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(UN). 
```

```
*HYPERBOLIC. 

COMPUTE ASMTHYPER=1-(1/ASMT). 
EXECUTE. 

MIXED TCBCEXTT WITH cond10 ASMTHYPER 
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)  
    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)     
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3) 
  /METHOD=ML 
  /PRINT=SOLUTION TESTCOV 
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(UN). 
```

Piecewise Coding: 

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG-40.png")
```

```
*PIECEWISE.

IF  (ASMT <  3) ASMTd3c6p1=ASMT-3. 
EXECUTE. 

IF  (ASMT >= 3) ASMTd3c6p1=0. 
EXECUTE. 

IF  (ASMT  <=  3) ASMTd3c6p2=-3. 
EXECUTE. 

IF  (ASMT > 3) ASMTd3c6p2=ASMT-6. 
EXECUTE. 

MIXED TCBCEXTT WITH cond10 ASMTd3c6p1 ASMTd3c6p2 
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1)  
    SINGULAR(0.000000000001) HCONVERGE(0, ABSOLUTE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0.000001, ABSOLUTE)     
  /FIXED=cond10 ASMTd3c6p1 ASMTd3c6p2 cond10*ASMTd3c6p1 cond10*ASMTd3c6p2 | SSTYPE(3) 
  /METHOD=ML 
  /PRINT=SOLUTION TESTCOV 
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(UN). 
```

```
*ANOVA.

MIXED TCBCEXTT BY ASMT cond10
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=ASMT cond10 ASMT*cond10 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(UN).
```

Hyperbolic GCM fit best, AIC = 2297.907, BIC = 2393.111

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG-41.png")
```

Assessing fit of covariance structures: 

```
*TOEPLITZ: HETEROGENEOUS. 

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(TPH).
```

```
*TOEPLITZ. 

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(TP).
```

```
*AR(1): HETEROGENEOUS. 

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT cond10 ASMTHYPER cond10*ASMTHYPER | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(ARH1).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT cond10 ASMTHYPER | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(ARH1).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT cond10 | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(ARH1).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT ASMTHYPER | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(ARH1).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(ARH1).
```

```
*AR(1). 

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT cond10 ASMTHYPER cond10*ASMTHYPER | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(AR1).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT cond10 ASMTHYPER | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(AR1).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT cond10 | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(AR1).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT ASMTHYPER | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(AR1).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(AR1).
```

```
*CS:HETEROGENEOUS. 

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(CSH).
```

```
*COMPOUND SYMMETRY.

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(CS).
```

```
*DIAGONAL. 

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT cond10 ASMTHYPER cond10*ASMTHYPER | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(DIAG).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT cond10 ASMTHYPER | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(DIAG).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT cond10 | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(DIAG).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT ASMTHYPER | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(DIAG).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(DIAG).
```

```
*SCALED IDENTITY. 

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT cond10 ASMTHYPER cond10*ASMTHYPER | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(ID).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT cond10 ASMTHYPER | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(ID).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT cond10 | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(ID).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT ASMTHYPER | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(ID).

MIXED TCBCEXTT WITH cond10 ASMTHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPER cond10*ASMTHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(SUBJECT) COVTYPE(UN)
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(ID).
```

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_42.png")
```

AR(1) ECM fit best, AIC = 2291.549, BIC = 2325.822

**Graph** 

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_43.png")
```

**1a. For the final (best-fitting) model only (the final growth model with the final ECM), are there differences in the slopes between the groups?**

The final (best-fitting) model (i.e., the final growth model with the final ECM) for Q1 was found to be the hyperbolic growth curve model with AR(1) error covariance matrix. 

```
COMPUTE ASMTHYPER=1-(1/ASMT). 
EXECUTE. 

COMPUTE ASMTHYPERc.67=ASMTHYPER - 0.67.
EXECUTE.

MIXED TCBCEXTT WITH cond10 ASMTHYPERc.67
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPERc.67 cond10*ASMTHYPERc.67 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(AR1).
```

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_36.png")
```

The difference of slope between the two conditions (PS and TAU) is significant, $b$ = 6.359, 95% CI = [0.236, 12.482], $t$(331) = 2.043, $p$ = 0.042.  

**1b. For the final (best-fitting) model only (the final growth model with the final ECM), are the slopes significant in each group?**

```
MIXED TCBCEXTT WITH cond10 ASMTHYPERc.67
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPERc.67 cond10*ASMTHYPERc.67 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(AR1).
```

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_37.png")
```

The slope of decrease in TCBCEXTT (child externalizing problems) is significant for the treatment group (receiving project support, i.e., PS), $b$ = -15.370, 95% CI = [-19.790, -10.951], $t$(331) = -6.841, $p$ < .001. 

```
RECODE cond10 (1=0) (0=1) INTO cond01.
VARIABLE LABELS  cond01 'TAU=0, PS=1'.
EXECUTE.
  
MIXED TCBCEXTT WITH cond01 ASMTHYPERc.67
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond01 ASMTHYPERc.67 cond01*ASMTHYPERc.67 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(AR1).
```

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_38.png")
```
The slope of decrease in TCBCEXTT (child externalizing problems) is also significant for the control group (receiving treatment as usual, i.e., TAU), $b$ = -9.011, 95% CI = [-13.249, -4.774], $t$(331) = -4.183, $p$ < .001. 

**1c. For the final (best-fitting) model only (the final growth model with the final ECM), are there differences between the groups at post-treatment vs. the final follow-up?**

```
MIXED TCBCEXTT WITH cond10 ASMTHYPERc.67
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPERc.67 cond10*ASMTHYPERc.67 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(AR1).
```

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_36.png")
```

```
COMPUTE ASMTHYPERc.83=ASMTHYPER - 0.83.
EXECUTE.

MIXED TCBCEXTT WITH cond10 ASMTHYPERc.83
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=cond10 ASMTHYPERc.83 cond10*ASMTHYPERc.83 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=ASMT | SUBJECT(SUBJECT) COVTYPE(AR1).
```

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_39.png")
```

The difference in the TCBCEXTT (child externalizing problems) slopes for the PS and TAU conditions is significant post treatment (at asmt=3), $b$ = 6.359, 95% CI = [0.236, 12.482], $t$(331) = 2.043, $p$ = 0.042. The interaction term does not change when recentering, so the difference in TCBCEXTT slopes for the two conditions is also significant at the final follow-up, $b$ = 6.359, 95% CI = [0.236, 12.482], $t$(331) = 2.043, $p$ = 0.042.

## Question 2

In the file DD.PSSI.new.sav, the outcome variable is % of days drinking (DDpct). There are 7 assessments, 4 weeks apart from each other (wk 0-24). The study is a randomized controlled trial with a treatment group (PE, for prolonged exposure, coded PBO0=1) and a control group (Placebo, coded PBO0=0). The intervention lasts 12wk, as does the follow-up. Wks 0-12 are during treatment. The follow-up (FU) period begins immediately after wk=12 (i.e., don’t use the jump/phase variable). Wks 16-24 are follow up asmts. Use wk as your Time variable in all analyses. The discontinuity is at end of treatment (wk 12). Answer the same 3 questions in question 1 (for the final, best-fitting model only), and graph your final model. Follow all the other instructions in question 1 also (e.g., describe the significant results, explain your process, fill out the Model Selection Table, and follow any other procedure outlined in Q1).

**Model Selection Table** 

Assessing fit of growth curve models: 

```
*LINEAR.

MIXED DDpct WITH PBO0 wk
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wk PBO0*wk | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=wk | SUBJECT(id) COVTYPE(UN).
```

```
*QUADRATIC.

COMPUTE wkSQ=wk ** 2.
EXECUTE.

MIXED DDpct WITH PBO0 wk wkSQ
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wk PBO0*wk wkSQ PBO0*wkSQ | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=wk | SUBJECT(id) COVTYPE(UN).
```

```
*LOG.

COMPUTE wkLN=LN(wk+1).
EXECUTE.

MIXED DDpct WITH PBO0 wkLN
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkLN PBO0*wkLN | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=wk | SUBJECT(id) COVTYPE(UN).
```

```
* HYPERBOLIC. 

COMPUTE wkHYPER=1-(1/(wk+1)).
EXECUTE.

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=wk | SUBJECT(id) COVTYPE(UN).
```

Piecewise coding: 

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_44.png")
```

```
*PIECEWISE.

IF  (wk < 12) wkd12c24p1=wk-12.
EXECUTE.

IF  (wk >= 12) wkd12c24p1=0.
EXECUTE.

IF  (wk <= 12) wkd12c24p2=-12.
EXECUTE.

IF  (wk > 12) wkd12c24p2=wk-24.
EXECUTE.

MIXED DDpct WITH PBO0 wkd12c24p1 wkd12c24p2
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkd12c24p1 wkd12c24p2 PBO0*wkd12c24p1 PBO0*wkd12c24p2 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=wk | SUBJECT(id) COVTYPE(UN).
```

```
*ANOVA.

MIXED DDpct BY PBO0 wk
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wk PBO0*wk | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=wk | SUBJECT(id) COVTYPE(UN).
```

Hyperbolic GCM fit best, AIC = 8185.582, BIC = 8342.726

Assessing fit of covariance structures: 

```
*TOEPLITZ: HETEROGENEOUS.

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=wk | SUBJECT(id) COVTYPE(TPH).
```

```
*TOEPLITZ. 

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=wk | SUBJECT(id) COVTYPE(TP).
```

```
*AR(1): HETEROGENEOUS.

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT PBO0 wkHYPER PBO0*wkHYPER | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(ARH1).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT PBO0 wkHYPER | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(ARH1).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT PBO0 | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(ARH1).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT wkHYPER | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(ARH1).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(ARH1).
```

```
*AR(1).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT PBO0 wkHYPER PBO0*wkHYPER | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(AR1).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT PBO0 wkHYPER | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(AR1).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT PBO0 | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(AR1).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT wkHYPER | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(AR1).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(AR1).
```

```
*CS: HETEROGENEOUS.

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(CSH).
```

```
*COMPOUND SYMMETRY. 

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=wk | SUBJECT(id) COVTYPE(CS).
```

```
*DIAGONAL.

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT PBO0 wkHYPER PBO0*wkHYPER | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(DIAG).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT PBO0 wkHYPER | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(DIAG).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT PBO0 | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(DIAG).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT wkHYPER | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(DIAG).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(DIAG).
```

```
*SCALED IDENTITY. 

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT PBO0 wkHYPER PBO0*wkHYPER | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(ID).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT PBO0 wkHYPER | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(ID).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT PBO0 | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(ID).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT wkHYPER | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(ID).

MIXED DDpct WITH PBO0 wkHYPER
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=PBO0 wkHYPER PBO0*wkHYPER | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /RANDOM=INTERCEPT | SUBJECT(id) COVTYPE(UN)
  /REPEATED=wk | SUBJECT(id) COVTYPE(ID).
```

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG-46.png")
```

Unstructured ECM fit best, AIC = 8185.582, BIC = 8342.726

**Graph**

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_47.png")
```

**2a. For the final (best-fitting) model only (the final growth model with the final ECM), are there differences in the slopes between the groups?**

The final (best-fitting) model (i.e., the final growth model with the final ECM) for Q2 was found to be the hyperbolic growth curve model with unstructured error covariance matrix. 

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_48.png")
```

The difference in the DDpct (percentage days of drinking) slopes for the prolonged exposure (PE) and placebo (PBO) conditions is not significant, $b$ = 1.849, 95% CI: [-7.047, 10.745], $t$(1151) = .41, $p$ = .682.

**2b. For the final (best-fitting) model only (the final growth model with the final ECM), are the slopes significant in each group?**

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_49.png")
```

The slope for DDpct (% days drinking) is significant for the condition coded 0 for PBO0, which is the placebo condition, $b$ = -69.376, 95% CI: [-75.578, -63.173], $t$(1151) = -22.088, $p$ < .001. 

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_50.png")
```

The slope for DDpct (% days drinking) is also significant for the condition coded 0 for PE0, which is the treatment (prolonged exposure; PE) condition, $b$ = -67.527, 95% CI: [-73.905, -61.149], $t$(1151) = -20.908, $p$ < .001. 

**2c. For the final (best-fitting) model only (the final growth model with the final ECM), are there differences between the groups at post-treatment vs. the final follow-up? **

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_51.png")
```

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_52.png")
```

The difference in DDpct (% days drinking) for the treatment (prolonged exposure; PE) and placebo (PBO) conditions post-treatment (at wk=12) is not statistically significant as explained in question 2A, $b$=2.774, 95% CI: [-2.203, 7.751], $t$(1151)=1.102, $p$=.272. The difference in DDpct at the final follow-up (at wk=24) is also not significant, $b$ = 2.848, 95% CI: [-2.290, 7.986], $t$(1151) = 1.096, $p$ = .275. 

## Bonus Question 

**The attached data set are results comparing 2 treatments for PTSD (coded in the variable innovatively named “condition”; person centered therapy=0, prolonged exposure=1). The outcome is CPSSIE, which measures PTSD severity. Use asmt as your time variable. The discontinuity is at asmt=16. Center time at the last assessment (asmt=19).**

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG-53.png")
```

```
IF  (asmt < 16) asmtd16c19p1=asmt-16.
EXECUTE.

IF  (asmt >= 16) asmtd16c19p1=0.
EXECUTE.

IF  (asmt <= 16) asmtd16c19p2=-3.
EXECUTE.

IF  (asmt > 16) asmtd16c19p2=asmt-19.
EXECUTE.

MIXED CPSSIE WITH condition asmtd16c19p1 asmtd16c19p2
  /CRITERIA=DFMETHOD(SATTERTHWAITE) CIN(95) MXITER(1000) MXSTEP(100) SCORING(1) 
    SINGULAR(0.000000000001) HCONVERGE(0.00000001, RELATIVE) LCONVERGE(0, ABSOLUTE) PCONVERGE(0, 
    ABSOLUTE)
  /FIXED=condition asmtd16c19p1 asmtd16c19p2 condition*asmtd16c19p1 condition*asmtd16c19p2 | SSTYPE(3)
  /METHOD=ML
  /PRINT=SOLUTION TESTCOV
  /REPEATED=asmt| SUBJECT(SubjectID) COVTYPE(UN).
```

```{r, echo = FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/carolinelee78/mlmbookdown/main/_figures/IMG_54.png")
```

Interpretation of fixed effects: 

- `Condition`: The difference between the two conditions (PCT and PE) in terms of CPSSIE is significant at the last assessment (asmt=19). 
- `asmtd16c19p1`: The slope of decrease in PTSD severity for participants in the person centered therapy condition is significant for phase 1. 
- `asmtd16c19p2`: Holding all else constant, the slope of decrease in PTSD severity for participants in the person centered therapy condition is not significant for phase 2. 
- `Condition*asmtd16c19p1`: The change in CPSSIE over time is significantly different between the two conditions for the first phase of the study, with the rate of decrease in CPSSIE being more negative in PE condition than in the PCT condition for phase 1. 
- `Condition*asmtd16c19p2`: The change in CPSSIE over time between the two conditions was not significantly different for the second phase of the study. 







